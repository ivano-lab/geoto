<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Mapa Experimental - Trilhando Rios</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.5/dist/leaflet.css"
          integrity="sha256-sA+SkHqlkR9F0tXz6dE4ZcSb3i0u0Hw3FJ4yGmM0Mnk=" crossorigin=""/>
    <style>
        /* Estilos B√°sicos (Para Telas Grandes e Pequenas) */
        body {
            font-family: 'Roboto', sans-serif;
            background: #f4f4f9;
            color: #333;
            text-align: center;
            padding: 2rem;
            /* Garante que o padding n√£o cause overflow horizontal */
            box-sizing: border-box;
            min-width: 320px; /* Evita que telas min√∫sculas fiquem muito apertadas */
        }

        h1 {
            color: #1345B5;
            font-size: 2rem; /* Tamanho padr√£o */
        }

        select, button {
            padding: 0.8rem;
            margin: 0.5rem;
            border-radius: 8px;
            border: 2px solid #1345B5;
            font-size: 1rem;
            width: auto; /* Deixa o bot√£o se ajustar ao conte√∫do */
        }

        /* Torna o select e o bot√£o 100% da largura em telas pequenas para melhor toque */
        .controls-container {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap; /* Permite que os itens quebrem para a linha de baixo */
        }

        button {
            background-color: #FFD901;
            color: #1345B5;
            cursor: pointer;
            transition: 0.3s;
        }

        button:hover {
            background-color: #e0c800;
        }

        #resultado {
            margin-top: 1rem;
            background: white;
            padding: 1rem;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        pre {
            text-align: left;
            background: #eee;
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
            /* Adicionado para telas pequenas */
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        #map {
            margin-top: 2rem;
            height: 500px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            /* Garante que o mapa se ajuste ao tamanho do cont√™iner */
            width: 100%;
        }

        /* -------------------------------------- */
        /* MEDIA QUERIES (Regras de Responsividade) */
        /* -------------------------------------- */

        /* Para telas menores que 600px (smartphones) */
        @media (max-width: 600px) {
            body {
                padding: 1rem; /* Reduz o padding em telas pequenas */
            }

            h1 {
                font-size: 1.5rem; /* Reduz o tamanho do t√≠tulo */
            }

            p {
                font-size: 0.9rem;
            }

            /* Faz o select e o bot√£o ocuparem a largura total da tela */
            .controls-container {
                flex-direction: column;
            }

            select, button {
                width: 100%; /* Ocupa 100% do espa√ßo dispon√≠vel para facilitar o clique */
                margin: 0.5rem 0;
            }

            #map {
                height: 350px; /* Reduz a altura do mapa para caber melhor na tela */
            }

            #resultado {
                padding: 0.7rem;
            }
        }
    </style>
</head>
<body>
    <h1>Trilhando Rios - M√≥dulo Experimental</h1>
    <p>Selecione uma cidade para consultar suas coordenadas geogr√°ficas.</p>

    <div class="controls-container">
        <select id="cidadeSelect">
            <option value="">-- Escolha uma cidade --</option>
        </select>
        <button onclick="buscarCoordenadas()">Buscar Geocoordenadas</button>
    </div>

    <div id="resultado"></div>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.5/dist/leaflet.js"
            integrity="sha256-uMnJ7XVtgi6Rrrh4W8/7v5hSRwZs2cM9I2pF0v+DkVY=" crossorigin=""></script>
    <script>
        // ... (O resto do seu script JavaScript permanece o mesmo)
        const municipiosTO = [
            "Palmas","Aragua√≠na","Gurupi","Porto Nacional","Para√≠so do Tocantins","Colinas do Tocantins",
            "Guara√≠","Miracema do Tocantins","Araguatins","Formoso do Araguaia","Alvorada",
            "Aparecida do Rio Negro","Araguacema","Arapoema","Arraias","Augustin√≥polis","Aurora do Tocantins",
            "Axix√° do Tocantins","Baba√ßul√¢ndia","Barra do Ouro","Barrol√¢ndia","Bernardo Say√£o",
            "Bom Jesus do Tocantins","Brasil√¢ndia do Tocantins","Brejinho de Nazar√©","Buriti do Tocantins",
            "Cachoeirinha","Campos Lindos","Cariri do Tocantins","Carmol√¢ndia","Carrasco Bonito",
            "Caseara","Centen√°rio","Chapada da Natividade","Chapada de Areia","Combinado",
            "Concei√ß√£o do Tocantins","Couto de Magalh√£es","Cristal√¢ndia","Crix√°s do Tocantins",
            "Darcin√≥polis","Dian√≥polis","Divin√≥polis do Tocantins","Dois Irm√£os do Tocantins","Duer√©",
            "Esperantina","F√°tima","Figueir√≥polis","Filad√©lfia","Fortaleza do Taboc√£o","Goianorte",
            "Goiatins","Guara√≠","Ipueiras","Itacaj√°","Itaguatins","Itapiratins",
            "Itapor√£ do Tocantins","Ja√∫ do Tocantins","Juarina","Lagoa da Confus√£o","Lagoa do Tocantins",
            "Lajeado","Lavandeira","Lizarda","Luzin√≥polis","Marian√≥polis do Tocantins","Mateiros",
            "Mauril√¢ndia do Tocantins","Miracema do Tocantins","Miranorte","Monte do Carmo","Monte Santo do Tocantins",
            "Palmeirante","Palmeiras do Tocantins","Palmeir√≥polis","Para√≠so do Tocantins",
            "Paran√£","Pau D'Arco","Pedro Afonso","Peixe","Pequizeiro","Pindorama do Tocantins","Piraqu√™",
            "Pium","Ponte Alta do Bom Jesus","Ponte Alta do Tocantins","Porto Alegre do Tocantins",
            "Porto Nacional","Praia Norte","Presidente Kennedy","Pugmil","Recursol√¢ndia","Riachinho",
            "Rio da Concei√ß√£o","Rio dos Bois","Rio Sono","Sampaio","Sandol√¢ndia","Santa F√© do Araguaia",
            "Santa Maria do Tocantins","Santa Rita do Tocantins","Santa Rosa do Tocantins","Santa Tereza do Tocantins",
            "Santa Terezinha do Tocantins","S√£o Bento do Tocantins","S√£o F√©lix do Tocantins",
            "S√£o Miguel do Tocantins","S√£o Salvador do Tocantins","S√£o Sebasti√£o do Tocantins",
            "S√£o Val√©rio","Silvan√≥polis","S√≠tio Novo do Tocantins","Sucupira"
        ];

        // Preencher select
        const select = document.getElementById("cidadeSelect");
        municipiosTO.forEach(cidade => {
            const opt = document.createElement("option");
            opt.value = cidade + ", Tocantins, Brasil";
            opt.textContent = cidade;
            select.appendChild(opt);
        });

        // Inicializa o mapa
        const map = L.map('map').setView([-10.25, -48.25], 6); // centro do Tocantins
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        let marker;

        // Fun√ß√£o para buscar coordenadas e mostrar no mapa
        async function buscarCoordenadas() {
            const cidade = select.value;
            const resultadoDiv = document.getElementById("resultado");

            if (!cidade) {
                resultadoDiv.innerHTML = "<p>‚ö†Ô∏è Por favor, selecione uma cidade.</p>";
                return;
            }

            resultadoDiv.innerHTML = "<p>üîÑ Buscando dados...</p>";

            const resposta = await fetch(`/buscar_local?q=${encodeURIComponent(cidade)}`);
            const dados = await resposta.json();

            if (dados.length === 0) {
                resultadoDiv.innerHTML = "<p>Nenhum resultado encontrado.</p>";
                return;
            }

            const info = dados[0];
            resultadoDiv.innerHTML = `
                <h2>${info.display_name}</h2>
                <p><strong>Latitude:</strong> ${info.lat}</p>
                <p><strong>Longitude:</strong> ${info.lon}</p>
                <pre>${JSON.stringify(info, null, 2)}</pre>
            `;

            // Atualiza mapa
            if (marker) map.removeLayer(marker);
            marker = L.marker([info.lat, info.lon]).addTo(map)
                .bindPopup(`<b>${info.display_name}</b><br>Lat: ${info.lat}, Lon: ${info.lon}`)
                .openPopup();
            map.setView([info.lat, info.lon], 12);
        }
    </script>
</body>
</html>